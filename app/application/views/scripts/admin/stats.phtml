<style>
  #page-container {
    display: flex;
    gap: 20px;
  }
  #main {
    flex: 1;
    min-width: 0;
  }
  #aside {
    width: 250px;
    flex-shrink: 0;
  }
  .stats-nav {
    background: #f3edd5;
    padding: 15px;
    border-radius: 4px;
  }
  .stats-nav h3 {
    color: #392312;
    margin: 0 0 10px 0;
    padding-bottom: 10px;
    border-bottom: 2px solid #d0c17e;
    font-size: 16px;
  }
  .stats-nav ul {
    list-style: none;
    padding: 0;
    margin: 0;
  }
  .stats-nav li {
    margin: 0;
  }
  .stats-nav a {
    display: block;
    padding: 8px 10px;
    color: #392312;
    text-decoration: none;
    border-radius: 3px;
    transition: background 0.2s;
  }
  .stats-nav a:hover {
    background: #EEE4BE;
  }
  .stats-section {
    margin-bottom: 30px;
    background: #f3edd5;
    padding: 20px;
    border-radius: 4px;
    scroll-margin-top: 20px;
  }
  .stats-section h2 {
    color: #392312;
    border-bottom: 2px solid #d0c17e;
    padding-bottom: 8px;
    margin-bottom: 16px;
  }
  .stats-section h3 {
    color: #766C45;
    margin: 20px 0 10px 0;
  }
  .stats-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 15px;
    margin-bottom: 20px;
  }
  .stat-box {
    background: #EEE4BE;
    padding: 15px;
    border-radius: 4px;
    border-left: 4px solid #ac9d59;
  }
  .stat-box strong {
    color: #392312;
    display: block;
    margin-bottom: 5px;
  }
  .stats-section table {
    width: 100%;
    margin-top: 10px;
    background: #f3edd5;
  }
  .stats-section table th {
    background: #EEE4BE;
    color: #392312;
    padding: 10px;
    font-weight: bold;
  }
  .stats-section table td {
    padding: 8px;
    border-bottom: 1px solid #EEE4BE;
  }
  .stats-section a {
    color: rgb(0, 0, 238);
    text-decoration: none;
  }
  .stats-section a:hover {
    text-decoration: underline;
  }
  .stats-section a:visited {
    color: rgb(85, 26, 139);
  }
  @media (max-width: 768px) {
    #page-container {
      flex-direction: column;
    }
    #aside {
      width: 100%;
    }
  }
</style>

<div id="page-container">
  <div id="main">
    <h1>Statystyki HHBD - Panel Admina</h1>

    <!-- Summary Section -->
    <section id="summary" class="stats-section">
      <h2>ğŸ“Š Podsumowanie <a href="#page-container" style="float: right; font-size: 0.8em;">ğŸ” Do gÃ³ry</a></h2>
      <div class="stats-grid">
        <div class="stat-box">
          <strong>Albumy:</strong> 
          <?php echo number_format($this->summaryStats['totalAlbums'], 0, ',', ' '); ?><br>
          <small><?php echo $this->summaryStats['albumCoverPercentage']; ?>% z okÅ‚adkami</small>
        </div>
        <div class="stat-box">
          <strong>Wykonawcy:</strong> 
          <?php echo number_format($this->summaryStats['totalArtists'], 0, ',', ' '); ?><br>
          <small><?php echo $this->summaryStats['artistPhotoPercentage']; ?>% ze zdjÄ™ciami</small>
        </div>
        <div class="stat-box">
          <strong>WytwÃ³rnie:</strong> 
          <?php echo number_format($this->summaryStats['totalLabels'], 0, ',', ' '); ?><br>
          <small><?php echo $this->summaryStats['labelLogoPercentage']; ?>% z logo</small>
        </div>
        <div class="stat-box">
          <strong>Newsy:</strong> 
          <?php echo number_format($this->summaryStats['totalNews'], 0, ',', ' '); ?>
        </div>
        <div class="stat-box">
          <strong>Komentarze:</strong> 
          <?php echo number_format($this->summaryStats['totalComments'], 0, ',', ' '); ?>
        </div>
        <div class="stat-box">
          <strong>ÅÄ…cznie wyÅ›wietleÅ„:</strong> 
          <?php echo number_format($this->summaryStats['totalViews'], 0, ',', ' '); ?>
        </div>
      </div>
    </section>

    <!-- Users Statistics -->
    <section id="users" class="stats-section">
      <h2>ğŸ‘¥ UÅ¼ytkownicy <a href="#page-container" style="float: right; font-size: 0.8em;">ğŸ” Do gÃ³ry</a></h2>
      <div class="stats-grid">
        <div class="stat-box">
          <strong>Wszyscy uÅ¼ytkownicy:</strong> <?php echo number_format($this->userStats['total'], 0, ',', ' '); ?>
        </div>
        <div class="stat-box">
          <strong>Administratorzy:</strong> <?php echo $this->userStats['admins']; ?>
        </div>
        <div class="stat-box">
          <strong>Zarejestrowani w tym miesiÄ…cu:</strong> <?php echo $this->userStats['thisMonth']; ?>
        </div>
        <div class="stat-box">
          <strong>Zarejestrowani w tym roku:</strong> <?php echo $this->userStats['thisYear']; ?>
        </div>
      </div>

      <h3>Najbardziej aktywni uÅ¼ytkownicy (logowania)</h3>
      <table>
        <tr>
          <th>Nazwa</th>
          <th>Liczba logowaÅ„</th>
          <th>Ostatnie logowanie</th>
        </tr>
        <?php foreach ($this->userStats['mostActive'] as $user): ?>
        <tr>
          <td>
              <a href="<?php echo $this->url(array('id' => $user['usr_id'], 'seo' => Jkl_Tools_Url::createUrl($user['usr_display_name'])), 'user'); ?>">
              <?php echo $this->escape($user['usr_display_name']); ?>
            </a>
          </td>
          <td><?php echo number_format($user['usr_login_count'], 0, ',', ' '); ?></td>
          <td><?php echo $this->escape($user['usr_last_login']); ?></td>
        </tr>
        <?php endforeach; ?>
      </table>

      <h3>Najnowsi uÅ¼ytkownicy</h3>
      <table>
        <tr>
          <th>Nazwa</th>
          <th>Email</th>
          <th>Data rejestracji</th>
        </tr>
        <?php foreach ($this->userStats['newest'] as $user): ?>
        <tr>
          <td>
              <a href="<?php echo $this->url(array('id' => $user['usr_id'], 'seo' => Jkl_Tools_Url::createUrl($user['usr_display_name'])), 'user'); ?>">
              <?php echo $this->escape($user['usr_display_name']); ?>
            </a>
          </td>
          <td><?php echo $this->escape($user['usr_email']); ?></td>
          <td><?php echo $this->escape($user['usr_added']); ?></td>
        </tr>
        <?php endforeach; ?>
      </table>
    </section>

    <!-- Albums Statistics -->
    <section id="albums" class="stats-section">
      <h2>ğŸ’¿ Albumy <a href="#page-container" style="float: right; font-size: 0.8em;">ğŸ” Do gÃ³ry</a></h2>
      <div class="stats-grid">
        <div class="stat-box">
          <strong>Wszystkie albumy:</strong> <?php echo number_format($this->albumStats['total'], 0, ',', ' '); ?>
        </div>
        <div class="stat-box">
          <strong>Z okÅ‚adkami:</strong> <?php echo number_format($this->albumStats['withCovers'], 0, ',', ' '); ?>
        </div>
        <div class="stat-box">
          <strong>Bez okÅ‚adek:</strong> <?php echo number_format($this->albumStats['withoutCovers'], 0, ',', ' '); ?>
        </div>
        <div class="stat-box">
          <strong>Z zerowÄ… liczbÄ… wyÅ›wietleÅ„:</strong> <?php echo number_format($this->albumStats['zeroViews'], 0, ',', ' '); ?>
        </div>
      </div>

      <h3>NajczÄ™Å›ciej oglÄ…dane albumy</h3>
      <table>
        <tr>
          <th>TytuÅ‚</th>
          <th>WyÅ›wietlenia</th>
        </tr>
        <?php foreach ($this->albumStats['mostViewed'] as $album): ?>
        <tr>
          <td>
              <a href="<?php echo $this->url(array('id' => $album['id'], 'seo' => Jkl_Tools_Url::createUrl($album['title'])), 'album'); ?>">
              <?php echo $this->escape($album['title']); ?>
            </a>
          </td>
          <td><?php echo number_format($album['viewed'], 0, ',', ' '); ?></td>
        </tr>
        <?php endforeach; ?>
      </table>

      <h3>Najnowsze albumy</h3>
      <table>
        <tr>
          <th>TytuÅ‚</th>
          <th>Data dodania</th>
        </tr>
        <?php foreach ($this->albumStats['newest'] as $album): ?>
        <tr>
          <td>
              <a href="<?php echo $this->url(array('id' => $album['id'], 'seo' => Jkl_Tools_Url::createUrl($album['title'])), 'album'); ?>">
              <?php echo $this->escape($album['title']); ?>
            </a>
          </td>
          <td><?php echo $this->escape($album['added']); ?></td>
        </tr>
        <?php endforeach; ?>
      </table>
    </section>

    <!-- Artists Statistics -->
    <section id="artists" class="stats-section">
      <h2>ğŸ¤ Wykonawcy <a href="#page-container" style="float: right; font-size: 0.8em;">ğŸ” Do gÃ³ry</a></h2>
      <div class="stats-grid">
        <div class="stat-box">
          <strong>Wszyscy wykonawcy:</strong> <?php echo number_format($this->artistStats['total'], 0, ',', ' '); ?>
        </div>
        <div class="stat-box">
          <strong>Ze zdjÄ™ciami:</strong> <?php echo number_format($this->artistStats['withPhotos'], 0, ',', ' '); ?>
        </div>
        <div class="stat-box">
          <strong>Bez zdjÄ™Ä‡:</strong> <?php echo number_format($this->artistStats['withoutPhotos'], 0, ',', ' '); ?>
        </div>
      </div>

      <h3>NajczÄ™Å›ciej oglÄ…dani wykonawcy</h3>
      <table>
        <tr>
          <th>Nazwa</th>
          <th>WyÅ›wietlenia</th>
        </tr>
        <?php foreach ($this->artistStats['mostViewed'] as $artist): ?>
        <tr>
          <td>
              <a href="<?php echo $this->url(array('id' => $artist['id'], 'seo' => Jkl_Tools_Url::createUrl($artist['name'])), 'artist'); ?>">
              <?php echo $this->escape($artist['name']); ?>
            </a>
          </td>
          <td><?php echo number_format($artist['viewed'], 0, ',', ' '); ?></td>
        </tr>
        <?php endforeach; ?>
      </table>

      <h3>Wykonawcy z najwiÄ™kszÄ… liczbÄ… albumÃ³w</h3>
      <table>
        <tr>
          <th>Nazwa</th>
          <th>Liczba albumÃ³w</th>
        </tr>
        <?php foreach ($this->artistStats['mostAlbums'] as $artist): ?>
        <tr>
          <td>
              <a href="<?php echo $this->url(array('id' => $artist['id'], 'seo' => Jkl_Tools_Url::createUrl($artist['name'])), 'artist'); ?>">
              <?php echo $this->escape($artist['name']); ?>
            </a>
          </td>
          <td><?php echo $artist['album_count']; ?></td>
        </tr>
        <?php endforeach; ?>
      </table>

      <h3>PodziaÅ‚ wedÅ‚ug typu</h3>
      <table>
        <tr>
          <th>Typ</th>
          <th>Liczba</th>
        </tr>
        <?php
        $typeLabels = [
          'm' => 'MÄ™Å¼czyzna (wykonawca solo)',
          'f' => 'Kobieta (wykonawczyni solo)',
          'b' => 'ZespÃ³Å‚',
          'x' => 'Grupa producentÃ³w/inne'
        ];
          foreach ($this->artistStats['byType'] as $type):
              ?>
        <tr>
          <td><?php echo isset($typeLabels[$type['type']]) ? $typeLabels[$type['type']] : $this->escape($type['type']); ?></td>
          <td><?php echo $type['count']; ?></td>
        </tr>
        <?php endforeach; ?>
      </table>
    </section>

    <!-- Songs Statistics -->
    <section id="songs" class="stats-section">
      <h2>ğŸµ Utwory <a href="#page-container" style="float: right; font-size: 0.8em;">ğŸ” Do gÃ³ry</a></h2>
      <div class="stats-grid">
        <div class="stat-box">
          <strong>Wszystkie utwory:</strong> <?php echo number_format($this->songStats['total'], 0, ',', ' '); ?>
        </div>
        <div class="stat-box">
          <strong>Z tekstami:</strong> <?php echo number_format($this->songStats['withLyrics'], 0, ',', ' '); ?>
        </div>
        <div class="stat-box">
          <strong>Bez tekstÃ³w:</strong> <?php echo number_format($this->songStats['withoutLyrics'], 0, ',', ' '); ?>
        </div>
        <div class="stat-box">
          <strong>Z linkami YouTube:</strong> <?php echo number_format($this->songStats['withYoutube'], 0, ',', ' '); ?>
        </div>
      </div>

      <h3>NajczÄ™Å›ciej oglÄ…dane utwory</h3>
      <table>
        <tr>
          <th>TytuÅ‚</th>
          <th>WyÅ›wietlenia</th>
        </tr>
        <?php foreach ($this->songStats['mostViewed'] as $song): ?>
        <tr>
          <td>
              <a href="<?php echo $this->url(array('id' => $song['id'], 'seo' => Jkl_Tools_Url::createUrl($song['title'])), 'song'); ?>">
              <?php echo $this->escape($song['title']); ?>
            </a>
          </td>
          <td><?php echo number_format($song['viewed'], 0, ',', ' '); ?></td>
        </tr>
        <?php endforeach; ?>
      </table>
    </section>

    <!-- Labels Statistics -->
    <section id="labels" class="stats-section">
      <h2>ğŸ¢ WytwÃ³rnie <a href="#page-container" style="float: right; font-size: 0.8em;">ğŸ” Do gÃ³ry</a></h2>
      <div class="stats-grid">
        <div class="stat-box">
          <strong>Wszystkie wytwÃ³rnie:</strong> <?php echo number_format($this->labelStats['total'], 0, ',', ' '); ?>
        </div>
        <div class="stat-box">
          <strong>Z logo:</strong> <?php echo number_format($this->labelStats['withLogos'], 0, ',', ' '); ?>
        </div>
      </div>

      <h3>WytwÃ³rnie z najwiÄ™kszÄ… liczbÄ… albumÃ³w</h3>
      <table>
        <tr>
          <th>Nazwa</th>
          <th>Liczba albumÃ³w</th>
        </tr>
        <?php foreach ($this->labelStats['mostAlbums'] as $label): ?>
        <tr>
          <td>
              <a href="<?php echo $this->url(array('id' => $label['id'], 'seo' => Jkl_Tools_Url::createUrl($label['name'])), 'label'); ?>">
              <?php echo $this->escape($label['name']); ?>
            </a>
          </td>
          <td><?php echo $label['album_count']; ?></td>
        </tr>
        <?php endforeach; ?>
      </table>
    </section>

    <!-- Comments Statistics -->
    <section id="comments" class="stats-section">
      <h2>ğŸ’¬ Komentarze <a href="#page-container" style="float: right; font-size: 0.8em;">ğŸ” Do gÃ³ry</a></h2>
      <div class="stats-grid">
        <div class="stat-box">
          <strong>Wszystkie komentarze:</strong> <?php echo number_format($this->commentStats['total'], 0, ',', ' '); ?>
        </div>
        <div class="stat-box">
          <strong>W tym miesiÄ…cu:</strong> <?php echo number_format($this->commentStats['thisMonth'], 0, ',', ' '); ?>
        </div>
      </div>

      <h3>NajczÄ™Å›ciej komentowane albumy</h3>
      <table>
        <tr>
          <th>Album</th>
          <th>Liczba komentarzy</th>
        </tr>
        <?php foreach ($this->commentStats['mostCommentedAlbums'] as $album): ?>
        <tr>
          <td>
              <a href="<?php echo $this->url(array('id' => $album['id'], 'seo' => Jkl_Tools_Url::createUrl($album['title'])), 'album'); ?>">
              <?php echo $this->escape($album['title']); ?>
            </a>
          </td>
          <td><?php echo $album['comment_count']; ?></td>
        </tr>
        <?php endforeach; ?>
      </table>

      <h3>Najbardziej aktywni komentujÄ…cy</h3>
      <table>
        <tr>
          <th>UÅ¼ytkownik</th>
          <th>Liczba komentarzy</th>
        </tr>
        <?php foreach ($this->commentStats['mostActiveCommenters'] as $user): ?>
        <tr>
          <td>
              <a href="<?php echo $this->url(array('id' => $user['usr_id'], 'seo' => Jkl_Tools_Url::createUrl($user['usr_display_name'])), 'user'); ?>">
              <?php echo $this->escape($user['usr_display_name']); ?>
            </a>
          </td>
          <td><?php echo $user['comment_count']; ?></td>
        </tr>
        <?php endforeach; ?>
      </table>
    </section>

    <!-- Ratings Statistics -->
    <section id="ratings" class="stats-section">
      <h2>â­ Oceny <a href="#page-container" style="float: right; font-size: 0.8em;">ğŸ” Do gÃ³ry</a></h2>
      <div class="stats-grid">
        <div class="stat-box">
          <strong>Wszystkie oceny albumÃ³w:</strong> <?php echo number_format($this->ratingStats['totalAlbum'], 0, ',', ' '); ?>
        </div>
        <div class="stat-box">
          <strong>Åšrednia liczba ocen na album:</strong> <?php echo number_format($this->ratingStats['avgRatingsPerAlbum'], 1, ',', ' '); ?>
        </div>
      </div>

      <h3>NajwyÅ¼ej oceniane albumy (minimum 5 ocen)</h3>
      <table>
        <tr>
          <th>Album</th>
          <th>Ocena</th>
          <th>Liczba ocen</th>
        </tr>
        <?php foreach ($this->ratingStats['highestRatedAlbums'] as $album): ?>
        <tr>
          <td>
              <a href="<?php echo $this->url(array('id' => $album['albumid'], 'seo' => Jkl_Tools_Url::createUrl($album['title'])), 'album'); ?>">
              <?php echo $this->escape($album['title']); ?>
            </a>
          </td>
          <td><?php echo number_format($album['rating'], 2, ',', ' '); ?>/6</td>
          <td><?php echo $album['howmany']; ?></td>
        </tr>
        <?php endforeach; ?>
      </table>

      <h3>NajczÄ™Å›ciej oceniane albumy</h3>
      <table>
        <tr>
          <th>Album</th>
          <th>Liczba ocen</th>
          <th>Åšrednia ocena</th>
        </tr>
        <?php foreach ($this->ratingStats['mostRatedAlbums'] as $album): ?>
        <tr>
          <td>
              <a href="<?php echo $this->url(array('id' => $album['albumid'], 'seo' => Jkl_Tools_Url::createUrl($album['title'])), 'album'); ?>">
              <?php echo $this->escape($album['title']); ?>
            </a>
          </td>
          <td><?php echo $album['howmany']; ?></td>
          <td><?php echo $album['rating'] ? number_format($album['rating'], 2, ',', ' ') . '/6' : 'brak'; ?></td>
        </tr>
        <?php endforeach; ?>
      </table>
    </section>

    <!-- Content Gaps -->
    <section id="content-gaps" class="stats-section">
      <h2>âš ï¸ Luki w treÅ›ci</h2>
      <div class="stats-grid">
        <div class="stat-box">
          <strong>Albumy bez utworÃ³w:</strong> <?php echo number_format($this->contentGaps['albumsWithoutSongs'], 0, ',', ' '); ?>
        </div>
        <div class="stat-box">
          <strong>Wykonawcy bez albumÃ³w:</strong> <?php echo number_format($this->contentGaps['artistsWithoutAlbums'], 0, ',', ' '); ?>
        </div>
        <div class="stat-box">
          <strong>Albumy bez komentarzy:</strong> <?php echo number_format($this->contentGaps['albumsWithoutComments'], 0, ',', ' '); ?>
        </div>
        <div class="stat-box">
          <strong>Albumy bez ocen:</strong> <?php echo number_format($this->contentGaps['albumsWithoutRatings'], 0, ',', ' '); ?>
        </div>
      </div>
    </section>

    <!-- Recent Activity -->
    <section id="recent-activity" class="stats-section">
      <h2>ğŸ”„ Ostatnia aktywnoÅ›Ä‡ <a href="#page-container" style="float: right; font-size: 0.8em;">ğŸ” Do gÃ³ry</a></h2>

      <h3>Ostatnie komentarze</h3>
      <table>
        <tr>
          <th>TreÅ›Ä‡</th>
          <th>UÅ¼ytkownik</th>
          <th>Data</th>
        </tr>
        <?php foreach ($this->recentActivity['recentComments'] as $comment): ?>
        <tr>
          <td><?php echo $this->escape(mb_substr($comment['com_content'], 0, 100)) . (mb_strlen($comment['com_content']) > 100 ? '...' : ''); ?></td>
          <td>
            <a href="<?php echo $this->url(array('id' => $comment['usr_id'], 'seo' => Jkl_Tools_Url::createUrl($comment['usr_display_name'])), 'user'); ?>">
              <?php echo $this->escape($comment['usr_display_name']); ?>
            </a>
          </td>
          <td><?php echo $this->escape($comment['com_added']); ?></td>
        </tr>
        <?php endforeach; ?>
      </table>

      <h3>Ostatnie oceny</h3>
      <table>
        <tr>
          <th>Album</th>
          <th>Ocena</th>
          <th>UÅ¼ytkownik</th>
          <th>Data</th>
        </tr>
        <?php foreach ($this->recentActivity['recentRatings'] as $rating): ?>
        <tr>
          <td>
            <a href="<?php echo $this->url(array('id' => $rating['albumid'], 'seo' => Jkl_Tools_Url::createUrl($rating['title'])), 'album'); ?>">
              <?php echo $this->escape($rating['title']); ?>
            </a>
          </td>
          <td><?php echo $rating['rate']; ?>/6</td>
          <td>
            <?php if ($rating['usr_id']): ?>
              <a href="<?php echo $this->url(array('id' => $rating['usr_id'], 'seo' => Jkl_Tools_Url::createUrl($rating['usr_display_name'])), 'user'); ?>">
                <?php echo $this->escape($rating['usr_display_name']); ?>
              </a>
            <?php else: ?>
              <em>UsuniÄ™ty uÅ¼ytkownik</em>
            <?php endif; ?>
          </td>
          <td><?php echo $this->escape($rating['added']); ?></td>
        </tr>
        <?php endforeach; ?>
      </table>
    </section>
  </div>

  <div id="aside">
    <div class="stats-nav">
      <h3>Nawigacja</h3>
      <ul>
        <li><a href="#summary">ğŸ“Š Podsumowanie</a></li>
        <li><a href="#users">ğŸ‘¥ UÅ¼ytkownicy</a></li>
        <li><a href="#albums">ğŸ’¿ Albumy</a></li>
        <li><a href="#artists">ğŸ¤ Wykonawcy</a></li>
        <li><a href="#songs">ğŸµ Utwory</a></li>
        <li><a href="#labels">ğŸ¢ WytwÃ³rnie</a></li>
        <li><a href="#comments">ğŸ’¬ Komentarze</a></li>
        <li><a href="#ratings">â­ Oceny</a></li>
        <li><a href="#content-gaps">âš ï¸ Luki w treÅ›ci</a></li>
        <li><a href="#recent-activity">ğŸ”„ Ostatnia aktywnoÅ›Ä‡</a></li>
      </ul>
    </div>
  </div>
</div>
